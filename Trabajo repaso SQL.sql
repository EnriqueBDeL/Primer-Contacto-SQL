
CREATE TABLE ACTORES(
    ID INT PRIMARY KEY, 
        NOMBRE VARCHAR2(50),
        FECHA_NACIMIENTO DATE,
        NACIONALIDAD VARCHAR2(50)
);




INSERT INTO ACTORES(ID, NOMBRE,FECHA_NACIMIENTO, NACIONALIDAD) VALUES(1,'Leonardo DeCabrios', TO_DATE('1974-11-11','YYYY-MM-DD'), 'Estadounidense');


INSERT INTO ACTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (2, 'Paco Tigretón', TO_DATE('1978-01-11', 'YYYY-MM-DD'), 'Española');

  
INSERT INTO ACTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (3, 'Vin Gasoil', TO_DATE('1978-02-23', 'YYYY-MM-DD'), 'Estadounidense');  


INSERT INTO ACTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (4, 'Scarlata HijadeJuan', TO_DATE('1984-11-22', 'YYYY-MM-DD'), 'Estadounidense');


INSERT INTO ACTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (5, 'Mario Pastas', TO_DATE('1986-05-12', 'YYYY-MM-DD'), 'Española');  










CREATE TABLE DIRECTORES(
    ID INT PRIMARY KEY, 
        NOMBRE VARCHAR2(50),
        FECHA_NACIMIENTO DATE,
        NACIONALIDAD VARCHAR2(50)
);



INSERT INTO DIRECTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (1, 'Steven Spilbero', TO_DATE('1974-11-11', 'YYYY-MM-DD'), 'Estadounidense');

  
INSERT INTO DIRECTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (2, 'Paco Tigretón', TO_DATE('1978-01-11', 'YYYY-MM-DD'), 'Española');

  
INSERT INTO DIRECTORES (ID, NOMBRE, FECHA_NACIMIENTO, NACIONALIDAD) VALUES (3, 'Pato Lucas', TO_DATE('1978-02-23', 'YYYY-MM-DD'), 'Estadounidense');  










CREATE TABLE PELICULAS(
    ID INT PRIMARY KEY, 
        TITULO VARCHAR2(50),
        ANO INT,
        DIRECTOR NUMBER,
        FOREIGN KEY(DIRECTOR) REFERENCES DIRECTORES(ID)
);




INSERT INTO PELICULAS (ID, TITULO, ANO, DIRECTOR) VALUES (1, 'Piratas del río Segura', 2010, 1);


INSERT INTO PELICULAS (ID, TITULO, ANO, DIRECTOR) VALUES (2, 'Paparajote Wars', 1978, 3);


INSERT INTO PELICULAS (ID, TITULO, ANO, DIRECTOR) VALUES (3, 'Paquita Salsas', 2020, 2);


INSERT INTO PELICULAS (ID, TITULO, ANO, DIRECTOR) VALUES (4, 'Slow and quiet 10', 2024, 1);


INSERT INTO PELICULAS (ID, TITULO, ANO, DIRECTOR) VALUES (5, 'Como matar a tu profe 2', 2023, 1);











CREATE TABLE PARTICIPAR_PELICULA(
    ACTOR_ID NUMBER, 
            FOREIGN KEY(ACTOR_ID) REFERENCES ACTORES(ID),
        PELICULA_ID NUMBER,
                    FOREIGN KEY(PELICULA_ID) REFERENCES PELICULAS(ID),
        PERSONAJE VARCHAR2(50),
        PRIMARY KEY (ACTOR_ID, PELICULA_ID)
);






-- Piratas del río Segura (2010)

INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (1, 1, 'Capitán Despistado');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (3, 1, 'Grumete Tontín');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (5, 1, 'Palmera');




-- Paparajote Wars (1978)

INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (2, 2, 'Maestro Limoncillo');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (4, 2, 'Hank Acompañado');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (5, 2, 'Darth Pimiento');




-- Paquita Salsas (2020)

INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (2, 3, 'Paquita Salsas');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (3, 3, 'La verdulera');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (4, 3, 'Maese Champiñon');




-- Slow and Quiet 10 (2024)

INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (3, 4, 'Dominic Tortuga');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (1, 4, 'Brian Relento');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (5, 4, 'Rueda derecha');




-- Como matar a tu profe 2 (2023)

INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (1, 5, 'Alumno Vengador');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (4, 5, 'Antonio Llanes');


INSERT INTO PARTICIPAR_PELICULA (ACTOR_ID, PELICULA_ID, PERSONAJE) VALUES (2, 5, 'Chico sin camisa');








--CONSULTAS:



-- Obtén todas las películas estrenadas después del año 2000.


SELECT *
FROM PELICULAS
WHERE ANO > 2000;




-- Muestra el nombre de los actores junto con las películas en las que han participado.


SELECT A.NOMBRE,E.TITULO
FROM ACTORES A
JOIN PARTICIPAR_PELICULA P ON A.ID = P.ACTOR_ID
JOIN PELICULAS E ON P.PELICULA_ID = E.ID;






-- Lista los actores y los personajes que interpretaron en "Piratas del río Segura".


SELECT A.NOMBRE,P.PERSONAJE
FROM ACTORES A
JOIN PARTICIPAR_PELICULA P ON A.ID = P.ACTOR_ID
JOIN PELICULAS E ON P.PELICULA_ID = E.ID
WHERE E.TITULO = 'Piratas del río Segura';





-- Muestra el número de películas en las que ha participado cada actor.


SELECT A.NOMBRE, COUNT(P.PELICULA_ID) AS NUMERO_DE_PELICULAS
FROM ACTORES A
JOIN PARTICIPAR_PELICULA P ON A.ID = P.ACTOR_ID
GROUP BY A.NOMBRE;





-- Encuentra las películas dirigidas por "Steven Spilbero".


SELECT TITULO
FROM PELICULAS
WHERE DIRECTOR = (
    SELECT ID
    FROM DIRECTORES
    WHERE NOMBRE = 'Steven Spilbero'
);





-- Encuentra la película más reciente en la base de datos


SELECT TITULO
FROM PELICULAS
WHERE ANO = (
    SELECT MAX(ANO) 
    FROM PELICULAS
);




-- Muestra el director que ha dirigido más películas.


SELECT D.NOMBRE
FROM DIRECTORES D
JOIN PELICULAS P ON P.DIRECTOR = D.ID
GROUP BY D.NOMBRE
HAVING COUNT(P.DIRECTOR) = (
    SELECT MAX(COUNT(P.DIRECTOR))
    FROM PELICULAS P
    GROUP BY P.DIRECTOR
);




